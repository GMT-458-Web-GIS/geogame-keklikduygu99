<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GeoGame — Turkish Cuisine</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
:root{
  --bg:#0f1624; --card:#0b1220; --accent:#00bcd4; --muted:#9fb6c1;
}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,#071229,#081827);color:#e8f6fb}
.wrap{max-width:1200px;margin:20px auto;padding:18px;display:flex;flex-direction:column;gap:12px}
.card{background:rgba(255,255,255,0.03);border-radius:12px;padding:14px}
header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}
h1{margin:0;font-size:20px}
.small{color:var(--muted);font-size:13px}
button{cursor:pointer;border-radius:8px;padding:10px 14px;border:none;font-weight:700;transition:0.3s}
.btn-primary{background:var(--accent);color:#012;box-shadow:0 6px 18px rgba(0,188,212,0.08)}
.btn-primary:hover{transform:scale(1.05); box-shadow:0 8px 22px rgba(0,188,212,0.3);}
.btn-ghost{background:transparent;color:#cfeefb;border:1px solid rgba(255,255,255,0.06)}
.top-right{display:flex;gap:14px;align-items:center}
.screen{display:none;margin-top:18px;text-align:center}
.screen.active{display:block}
.flex{display:flex;gap:14px;margin-top:12px;height:calc(100vh - 180px)}
.left{flex:0 0 300px;display:flex;flex-direction:column;gap:12px}
.right{flex:1;display:flex;flex-direction:column}
.dish-box{background:#081727;border-radius:8px;padding:12px;flex:1;display:flex;flex-direction:column;align-items:center;justify-content:flex-start}
#dishImg{max-width:100%;max-height:240px;border-radius:6px;background:#071227}
#map{flex:1;border-radius:8px}
.hint{color:var(--muted);font-size:14px;text-align:left}
.feedback{height:22px;margin-top:8px;text-align:center}
.scoreboard p{margin:6px 0}
@media (max-width:900px){.flex{flex-direction:column}.left{width:100%}.right{width:100%;height:400px}}

/* Start screen estetik */
#startScreen h2{font-size:28px; color:var(--accent); margin-bottom:12px;}
#startScreen .hint-box{background:rgba(0,188,212,0.1); padding:12px; border-radius:8px; margin:8px 0; font-size:16px;}
#startScreen .tip{font-style:italic; color:var(--muted); margin-top:8px;}
</style>
</head>
<body>
<div class="wrap card">
<header>
  <div>
    <h1>GeoGame — Turkish Cuisine</h1>
    <div class="small">+5 correct / −1 wrong • 60 seconds • Click the city on the map</div>
  </div>
  <div class="top-right">
    <div class="small">Time: <strong id="timer">60</strong>s</div>
    <div class="small">Score: <strong id="score">0</strong></div>
    <button id="resetBtn" class="btn-ghost">Reset</button>
  </div>
</header>

<!-- START SCREEN -->
<div id="startScreen" class="screen active">
  <h2>GeoGame — Turkish Cuisine</h2>
  <p class="hint-box">A famous Turkish dish will be shown (name & picture). Click the city on the map that you think the dish belongs to.</p>
  <p class="hint-box">Scoring: <strong>+5</strong> for correct, <strong>−1</strong> for wrong. You have <strong>60 seconds</strong>.</p>
  <p class="tip">Tip: Dishes are regional — e.g. Baklava → Gaziantep, Boyoz → Izmir, Tantuni → Mersin.</p>
  <div style="margin-top:20px;">
    <button id="startBtn" class="btn-primary">Start Game</button>
  </div>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen" class="screen">
  <div class="flex">
    <div class="left">
      <div class="dish-box">
        <img id="dishImg" alt="Dish image"/>
        <h3 id="dishName" style="margin-top:12px">Dish name</h3>
        <div id="feedback" class="feedback small"></div>
      </div>
    </div>
    <div class="right">
      <div id="map"></div>
    </div>
  </div>
</div>

<!-- SCOREBOARD -->
<div id="scoreScreen" class="screen score-screen">
  <h2>Scoreboard</h2>
  <p>Your score: <strong id="finalScore">0</strong></p>
  <p class="small">Play again to improve your score.</p>
  <div style="margin-top:10px"><button id="playAgain" class="btn-primary">Play Again</button></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>

// -----------------------
// DATA (81 şehir + placeholder image)
const CITIES = [
  {city:"Adana",lat:37.0017,lng:35.3289,dish:"Kebap",img:"images/kebap.jpg"},
  {city:"Adıyaman",lat:37.7648,lng:38.2763,dish:"Fıstıklı Tatlı",img:"images/fistikli_tatli.jpg"},
  {city:"Afyon",lat:38.7606,lng:30.5400,dish:"Sucuk",img:"images/sucuk.jpg"},
  {city:"Ağrı",lat:39.7191,lng:43.0503,dish:"Bal",img:"images/bal.jpg"},
  {city:"Amasya",lat:40.6521,lng:35.8339,dish:"Elma",img:"images/elma.jpg"},
  {city:"Ankara",lat:39.9334,lng:32.8597,dish:"Beypazarı Kurusu",img:"images/beypazari_kurusu.jpg"},
  {city:"Antalya",lat:36.8841,lng:30.7056,dish:"Piyaz",img:"images/piyaz.jpg"},
  {city:"Artvin",lat:41.1828,lng:41.8183,dish:"Hamsili Pilav",img:"images/hamsili_pilav.jpg"},
  {city:"Aydın",lat:37.8450,lng:27.8396,dish:"İncir Tatlısı",img:"images/incir_tatlisi.jpg"},
  {city:"Balıkesir",lat:39.6490,lng:27.8826,dish:"Manyas Tavuğu",img:"images/manyas_tavugu.jpg"},
  {city:"Bilecik",lat:40.1500,lng:29.9833,dish:"Hoşmerim",img:"images/hosmerim.jpg"},
  {city:"Bingöl",lat:38.8842,lng:40.4939,dish:"Tandır",img:"images/tandir.jpg"},
  {city:"Bitlis",lat:38.4010,lng:42.1120,dish:"Kaymak",img:"images/kaymak.jpg"},
  {city:"Bolu",lat:40.7395,lng:31.6116,dish:"Mengen Tavuğu",img:"images/mengen_tavugu.jpg"},
  {city:"Burdur",lat:37.7200,lng:30.2900,dish:"Burdur Şiş",img:"images/burdur_sis.jpg"},
  {city:"Bursa",lat:40.1955,lng:29.06,dish:"İskender",img:"images/iskender.jpg"},
  {city:"Çanakkale",lat:40.1553,lng:26.4142,dish:"Ezine Peyniri",img:"images/ezine_peyniri.jpg"},
  {city:"Çankırı",lat:40.6013,lng:33.6134,dish:"Bulgur Pilavı",img:"images/bulgur_pilavi.jpg"},
  {city:"Çorum",lat:40.5488,lng:34.9536,dish:"İskilip Dolması",img:"images/iskilip_dolmasi.jpg"},
  {city:"Denizli",lat:37.7765,lng:29.0864,dish:"Kuzu Tandır",img:"images/kuzu_tandir.jpg"},
  {city:"Diyarbakır",lat:37.9144,lng:40.2306,dish:"Kaburga Dolması",img:"images/kaburga_dolmasi.jpg"},
  {city:"Edirne",lat:41.6772,lng:26.5557,dish:"Ciğer Tava",img:"images/ciger_tava.jpg"},
  {city:"Elazığ",lat:38.6743,lng:39.2224,dish:"Harput Köftesi",img:"images/harput_kofte.jpg"},
  {city:"Erzincan",lat:39.7500,lng:39.5000,dish:"Tulum Peyniri",img:"images/tulum_peyniri.jpg"},
  {city:"Erzurum",lat:39.9056,lng:41.2658,dish:"Cağ Kebabı",img:"images/cag_kebabi.jpg"},
  {city:"Eskişehir",lat:39.7691,lng:30.5269,dish:"Çibörek",img:"images/ciborek.jpg"},
  {city:"Gaziantep",lat:37.0662,lng:37.3833,dish:"Baklava",img:"images/baklava.jpg"},
  {city:"Giresun",lat:40.9128,lng:38.3895,dish:"Mısır Ekmeği",img:"images/misir_ekmegi.jpg"},
  {city:"Gümüşhane",lat:40.4603,lng:39.4817,dish:"Kuymak",img:"images/kuymak.jpg"},
  {city:"Hakkari",lat:37.5744,lng:43.7407,dish:"Kavurma",img:"images/kavurma.jpg"},
  {city:"Hatay",lat:36.2021,lng:36.1741,dish:"Künefe",img:"images/kunefe.jpg"},
  {city:"Isparta",lat:37.7648,lng:30.5566,dish:"Gül Reçeli",img:"images/gul_receli.jpg"},
  {city:"Mersin",lat:36.8121,lng:34.6415,dish:"Tantuni",img:"images/tantuni.jpg"},
  {city:"Izmir",lat:38.4237,lng:27.1428,dish:"Boyoz",img:"images/boyoz.jpg"},
  {city:"Kars",lat:40.6013,lng:43.0940,dish:"Kaz Eti ve Kaz Tandırı",img:"images/kaz_tandiri.jpg"},
  {city:"Kastamonu",lat:41.3787,lng:33.7827,dish:"Çekme Helva",img:"images/cekme_helva.jpg"},
  {city:"Kayseri",lat:38.7312,lng:35.4787,dish:"Mantı",img:"images/manti.jpg"},
  {city:"Kırklareli",lat:41.7351,lng:27.2250,dish:"Hardal Otu Yemeği",img:"images/hardal_otu.jpg"},
  {city:"Kırşehir",lat:39.1450,lng:34.1637,dish:"İçli Köfte",img:"images/icli_kofte.jpg"},
  {city:"Kocaeli",lat:40.8533,lng:29.8815,dish:"Kelle Paça Çorbası",img:"images/kelle_paca.jpg"},
  {city:"Konya",lat:37.8746,lng:32.4932,dish:"Etli Ekmek",img:"images/etli_ekmek.jpg"},
  {city:"Kütahya",lat:39.4200,lng:29.9833,dish:"Ekmek Kadayıfı",img:"images/ekmek_kadayifi.jpg"},
  {city:"Malatya",lat:38.3553,lng:38.3095,dish:"Kayısı Tatlısı",img:"images/kayisi_tatlisi.jpg"},
  {city:"Manisa",lat:38.6191,lng:27.4289,dish:"Mesir",img:"images/mesir.jpg"},
  {city:"Kahramanmaraş",lat:37.5833,lng:36.9266,dish:"Maraş Dondurması",img:"images/maras_dondurmasi.jpg"},
  {city:"Mardin",lat:37.3212,lng:40.7249,dish:"Kaburga Dolması",img:"images/kaburga_dolmasi.jpg"},
  {city:"Muğla",lat:37.2153,lng:28.3636,dish:"Kabak Çiçeği Dolması",img:"images/kabak_cicegi.jpg"},
  {city:"Muş",lat:38.7467,lng:41.5981,dish:"Bal",img:"images/bal.jpg"},
  {city:"Nevşehir",lat:38.6240,lng:34.7130,dish:"Testi Kebabı",img:"images/testi_kebabi.jpg"},
  {city:"Niğde",lat:37.9667,lng:34.6833,dish:"Bamya Yemeği",img:"images/bamya_yemegi.jpg"},
  {city:"Ordu",lat:40.9860,lng:37.8796,dish:"Hamsi",img:"images/hamsi.jpg"},
  {city:"Rize",lat:41.0201,lng:40.5234,dish:"Laz Böreği",img:"images/laz_boregi.jpg"},
  {city:"Sakarya",lat:40.6761,lng:30.4300,dish:"Hendek Köftesi",img:"images/hendek_kofte.jpg"},
  {city:"Samsun",lat:41.2867,lng:36.3333,dish:"Çakallı Menemeni",img:"images/cakalli_menemeni.jpg"},
  {city:"Siirt",lat:37.9336,lng:41.9471,dish:"Büryan Kebabı",img:"images/buryan_kebabi.jpg"},
  {city:"Sinop",lat:42.0260,lng:35.1539,dish:"Cevizli Börek",img:"images/cevizli_borek.jpg"},
  {city:"Sivas",lat:39.7477,lng:37.0179,dish:"Kangal Sucuk",img:"images/kangal_sucuk.jpg"},
  {city:"Tekirdağ",lat:40.9787,lng:27.5116,dish:"Çerkez Tavuğu",img:"images/cerkez_tavugu.jpg"},
  {city:"Tokat",lat:40.3133,lng:36.5540,dish:"Zile Pekmezi",img:"images/zile_pekmezi.jpg"},
  {city:"Trabzon",lat:41.0015,lng:39.7178,dish:"Akçaabat Köfte",img:"images/akcabat_kofte.jpg"},
  {city:"Tunceli",lat:39.1082,lng:39.5417,dish:"Alabalık",img:"images/alabalik.jpg"},
  {city:"Şanlıurfa",lat:37.1674,lng:38.7960,dish:"Lahmacun",img:"images/lahmacun.jpg"},
  {city:"Uşak",lat:38.6820,lng:29.4082,dish:"Biber Dolması",img:"images/biber_dolmasi.jpg"},
  {city:"Van",lat:38.5010,lng:43.4167,dish:"Otlu Peynir",img:"images/otlu_peynir.jpg"},
  {city:"Yozgat",lat:39.8181,lng:34.8148,dish:"Tarhana Çorbası",img:"images/tarhana_corbasi.jpg"},
  {city:"Zonguldak",lat:41.4564,lng:31.7987,dish:"Bakla Yemeği",img:"images/bakla_yemegi.jpg"}
];

// -----------------------
// DOM
const startScreen = document.getElementById('startScreen');
const gameScreen  = document.getElementById('gameScreen');
const scoreScreen = document.getElementById('scoreScreen');
const startBtn    = document.getElementById('startBtn');
const playAgain   = document.getElementById('playAgain');
const resetBtn    = document.getElementById('resetBtn');
const timerEl     = document.getElementById('timer');
const scoreEl     = document.getElementById('score');
const finalScore  = document.getElementById('finalScore');
const dishImg     = document.getElementById('dishImg');
const dishName    = document.getElementById('dishName');
const feedback    = document.getElementById('feedback');

// -----------------------
// STATE
let score = 0;
let timeLeft = 60;
let timerId = null;
let currentIndex = null;
let markers = [];

// -----------------------
// MAP
const map = L.map('map', {preferCanvas:true, zoomControl:true}).setView([39,35],5);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution:'&copy; OpenStreetMap contributors',
  maxZoom:18
}).addTo(map);

// Turkey outline
const turkeyOutline = [
  [36.0,26.0],[38.5,25.5],[40.4,26.0],[41.5,27.0],[42.8,26.5],[43.6,27.5],
  [42.9,29.0],[43.4,30.5],[42.8,32.5],[41.7,33.0],[40.6,34.5],[40.2,35.9],
  [40.8,37.2],[40.4,38.2],[39.7,39.6],[38.7,39.2],[37.9,38.9],[37.3,38.5],
  [36.9,37.6],[36.5,36.9],[36.2,36.2],[36.1,35.3],[35.8,34.6],[36.0,33.8],
  [35.6,33.0],[35.7,32.0],[35.9,31.0],[36.6,30.2],[37.5,30.1],[38.3,29.5],
  [39.1,28.9],[39.8,28.3],[40.3,27.6],[39.6,26.8],[38.6,26.2],[37.2,26.0],
  [36.0,26.0]
];
L.polygon(turkeyOutline, {color:'#ffffff', weight:2, fill:false, opacity:0.9}).addTo(map);

// -----------------------
// HELPERS
function placeholderSVG(text){
  return 'data:image/svg+xml;utf8,' + encodeURIComponent(
    `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='500'><rect width='100%' height='100%' fill='%230b1520'/><text x='50%' y='50%' fill='%23cfeff7' font-size='28' dominant-baseline='middle' text-anchor='middle'>${text}</text></svg>`
  );
}

function placeMarkers(){
  markers.forEach(m=>map.removeLayer(m));
  markers = [];
  CITIES.forEach((c, idx)=>{
    const mk = L.circleMarker([c.lat,c.lng],{
      radius:8,color:'#2f3742',weight:1.6,fillColor:'#ffffff',fillOpacity:1
    }).addTo(map);
    mk.cityIndex=idx;
    mk.bindTooltip(c.city,{direction:'top',offset:[0,-8]});
    mk.on('click',()=>onMarkerClick(idx));
    markers.push(mk);
  });
}

function onMarkerClick(idx){
  if(timeLeft<=0) return;
  handleGuess(idx);
}

function handleGuess(idx){
  if(currentIndex===null) return;
  if(idx===currentIndex){
    score+=5;
    feedback.style.color='#7CFFBE';
    feedback.textContent='Correct! +5';
    markers[idx].setStyle({fillColor:'#28a745', fillOpacity:0.95});
  }else{
    score-=1;
    feedback.style.color='#ff9b9b';
    feedback.textContent=`Wrong! -1 (Correct: ${CITIES[currentIndex].city})`;
    markers[idx].setStyle({fillColor:'#e74c3c', fillOpacity:0.95});
    markers[currentIndex].setStyle({fillColor:'#28a745', fillOpacity:0.95});
  }
  scoreEl.textContent = score;
  setTimeout(()=>{
    markers.forEach(m=>m.setStyle({fillColor:'#ffffff', fillOpacity:1}));
    if(timeLeft>0) nextQuestion();
  },900);
}

function nextQuestion(){
  currentIndex = Math.floor(Math.random()*CITIES.length);
  const item = CITIES[currentIndex];
  dishName.textContent = item.dish;
  dishImg.src = item.img || placeholderSVG(item.dish);
  feedback.textContent='';
  map.setView([item.lat,item.lng],6,{animate:true,duration:0.6});
}

function startGame(){
  score=0; timeLeft=60;
  scoreEl.textContent=score;
  timerEl.textContent=timeLeft;
  startScreen.classList.remove('active');
  scoreScreen.classList.remove('active');
  gameScreen.classList.add('active');
  setTimeout(()=>{
    map.invalidateSize(true);
    placeMarkers();
    nextQuestion();
  },200);
  clearInterval(timerId);
  timerId=setInterval(()=>{
    timeLeft--;
    timerEl.textContent=timeLeft;
    if(timeLeft<=0) endGame();
  },1000);
}

function endGame(){
  clearInterval(timerId);
  gameScreen.classList.remove('active');
  scoreScreen.classList.add('active');
  finalScore.textContent=score;
}

// -----------------------
// EVENTS
startBtn.addEventListener('click',startGame);
playAgain.addEventListener('click',startGame);
resetBtn.addEventListener('click',()=>{
  clearInterval(timerId);
  score=0; timeLeft=60;
  scoreEl.textContent=score;
  timerEl.textContent=timeLeft;
  startScreen.classList.add('active');
  gameScreen.classList.remove('active');
  scoreScreen.classList.remove('active');
  map.setView([39,35],5);
  markers.forEach(m=>map.removeLayer(m));
  markers=[];
});

window.addEventListener('load', ()=> setTimeout(()=>map.invalidateSize(true),200));

</script>
</body>
</html>
